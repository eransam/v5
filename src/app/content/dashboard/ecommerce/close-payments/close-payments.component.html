<div class="main_div">
  <div class="userDetDiv_tatle">
    <div
      style="
        margin-left: 30px;
        display: flex;
        justify-content: center !important;
      "
    >
      <h3
        class="userDetLabel"
        style="justify-content: center !important; direction: rtl"
      >
        סגירת חודש:
      </h3>
    </div>
  </div>
  <div *ngIf="isLoading" class="loader"></div>

  <div *ngIf="!isLoading">
    <form
      class="form form-horizontal row-separator"
      (ngSubmit)="add()"
      [formGroup]="DetailsForm"
    >
      <div class="form-body text-right">
        <div
          class="row"
          style="margin-top: 40px; direction: rtl; margin-right: 25px"
        >
          <!-- בחר סוג תשלום -->

          <div
            class="year-select rtl_Style col-md-12"
            style="padding-top: 23px"
          >
            <div>סוג תשלום:</div>

            <select [(ngModel)]="payment" [formControl]="paymentControl">
              <option
                *ngFor="let obj of this.type_of_payment"
                [value]="obj.code"
              >
                {{ obj.code }} - {{ obj.name }}
              </option>
            </select>
          </div>

          <!-- רטרו \ שוטף -->
          <div
            class="year-select rtl_Style col-md-12"
            style="padding-top: 23px"
          >
            <div>
              <input
                type="radio"
                name="selectedOption2"
                [(ngModel)]="selected_option_status"
                [formControl]="selected_option_statusControl"
                value="1"
              />
              <label
                style="text-align: center; margin-top: 7px; margin-left: 10px"
                >שוטף</label
              >
            </div>

            <div>
              <input
                type="radio"
                name="selectedOption2"
                [(ngModel)]="selected_option_status"
                [formControl]="selected_option_statusControl"
                value="2"
              />
              <label
                style="text-align: center; margin-top: 7px; margin-left: 10px"
                >רטרו</label
              >
            </div>
          </div>

          <!-- בחר שלוחה -->
          <div
            class="year-select rtl_Style col-md-12"
            style="padding-top: 23px"
          >
            <div>שלוחה:</div>

            <select
              [(ngModel)]="chosenShloha"
              [formControl]="chosenShlohaControl"
              (change)="change_shloha()"
            >
              <option
                *ngFor="let obj of this.shlohot_cartificate"
                [value]="obj.code"
              >
                {{ obj.code }} - {{ obj.name }}
              </option>
            </select>
          </div>

          <!-- חיפוש לפי שנה -->
          <div
            class="year-select rtl_Style col-md-12"
            style="padding-top: 23px"
          >
            <div>שנה:</div>
            <input
              [(ngModel)]="chosenYear"
              [formControl]="chosenYearControl"
              type="number"
              style="width: 125px; height: 32px; padding: 5px"
            />
            <select
              [(ngModel)]="chosenYear"
              [formControl]="chosenYearControl"
              style="width: 30px; height: 32px; margin-left: 10px"
            >
              <option *ngFor="let year of years" [value]="year">
                {{ year }}
              </option>
            </select>
          </div>

          <!-- חיפוש לפי חודש -->
          <div
            class="year-select rtl_Style col-md-12"
            style="padding-top: 23px"
          >
            <div>חודש:</div>
            <select
              [(ngModel)]="chosenMonth"
              [formControl]="chosenMonthControl"
              style="width: 125px; height: 32px; margin-left: 10px"
            >
              <option *ngFor="let month of months" [value]="month.code">
                {{ month.name }}
              </option>
            </select>
          </div>

          <!-- כפתור חיפוש -->
          <div class="col-md-2" style="margin-bottom: 20px">
            <button
              class="btn btn-warning"
              style="
                margin-top: 35px !important;
                font-size: 25px !important;
                background-color: #3498db !important;
                border: none;
              "
              type="submit"
            >
              סגירת חודש
            </button>
          </div>

          <!-- כפתור מחיקה -->
          <div class="col-md-2" style="margin-bottom: 20px">
            <button
              class="btn btn-warning"
              style="
                margin-top: 35px !important;
                font-size: 25px !important;
                background-color: #3498db !important;
                border: none;
              "
              (click)="delete_month()"
              type="button"
            >
              מחיקת חודש
            </button>
          </div>

          <!--EXEL כפתור-->
          <!-- <div class="col-md-12 importBth" style="margin-top: 19px">
            <div class="justify-content importBth_div">
              <img
                style="height: 35px; margin-right: 10px"
                class=""
                src="assets/images/logo/excel.png"
                alt="Image"
                (click)="getExcelData()"
              />
              <p>({{ this.data.length }})</p>
            </div>
          </div> -->
        </div>
      </div>
    </form>
  </div>
  <div class="userDetDiv_tatle">
    <div
      style="
        margin-left: 30px;
        display: flex;
        justify-content: center !important;
      "
    >
      <h3
        class="userDetLabel"
        style="justify-content: center !important; direction: rtl"
      >
        ייצוא נתוני סגירה:
      </h3>
    </div>
  </div>
  <form
    class="form form-horizontal row-separator"
    (ngSubmit)="create_excel()"
    [formGroup]="excelForm"
  >
    <div class="form-body text-right">
      <div
        class="row"
        style="margin-top: 40px; direction: rtl; margin-right: 25px"
      >
        <!-- בחר סוג תשלום -->
        <div class="year-select rtl_Style col-md-2" style="padding-top: 23px">
          סוג תשלום:

          <select
            [(ngModel)]="payment_excel"
            [formControl]="paymentControl_excel"
          >
            <option *ngFor="let obj of this.type_of_payment" [value]="obj.code">
              {{ obj.code }} - {{ obj.name }}
            </option>
          </select>
        </div>

        <!-- בחר שלוחה -->
        <div class="year-select rtl_Style col-md-2" style="padding-top: 23px">
          שלוחה:
          <select
            [(ngModel)]="chosenShloha_excel"
            [formControl]="chosenShlohaControl_excel"
            (change)="change_shloha()"
          >
            <option
              *ngFor="let obj of this.shlohot_cartificate"
              [value]="obj.code"
            >
              {{ obj.code }} - {{ obj.name }}
            </option>
          </select>
        </div>

        <!-- חיפוש לפי שנה -->
        <div class="year-select rtl_Style col-md-2" style="padding-top: 23px">
          שנה:
          <input
            [(ngModel)]="chosenYear_excel"
            [formControl]="chosenYearControl_excel"
            type="number"
            style="width: 125px; height: 32px; padding: 5px"
          />
          <select
            [(ngModel)]="chosenYear_excel"
            [formControl]="chosenYearControl_excel"
            style="width: 30px; height: 32px; margin-left: 10px"
          >
            <option *ngFor="let year of years" [value]="year">
              {{ year }}
            </option>
          </select>
        </div>

        <!-- חיפוש לפי חודש -->
        <div class="year-select rtl_Style col-md-2" style="padding-top: 23px">
          חודש:
          <select
            [(ngModel)]="chosenMonth_excel"
            [formControl]="chosenMonthControl_excel"
            style="width: 125px; height: 32px; margin-left: 10px"
          >
            <option *ngFor="let month of months" [value]="month.code">
              {{ month.name }}
            </option>
          </select>
        </div>
        <div
          class="year-select rtl_Style col-md-4"
          style="padding-top: 23px"
        ></div>

        <!-- מפורט - ריכוז -->
        <div class="year-select rtl_Style col-md-1" style="margin-top: 30px">
          <input
            type="radio"
            name="selectedOption2_excel"
            [(ngModel)]="selected_option_status_excel"
            [formControl]="selected_option_statusControl_excel"
            value="merokaz"
          />
          <label style="text-align: center; margin-top: 7px; margin-left: 10px"
            >מרוכז</label
          >
        </div>

        <div class="year-select rtl_Style col-md-1" style="margin-top: 30px">
          <input
            type="radio"
            name="selectedOption2_excel"
            [(ngModel)]="selected_option_status_excel"
            [formControl]="selected_option_statusControl_excel"
            value="meforat"
          />
          <label style="text-align: center; margin-top: 7px; margin-left: 10px"
            >מפורט</label
          >
        </div>

        <!-- כפתור חיפוש -->
        <div class="col-md-12" style="margin-top: 15px">
          <button
            class="btn btn-warning"
            style="
              margin-top: 15px !important;
              font-size: 25px !important;
              background-color: #3498db !important;
              border: none;
            "
            type="submit"
          >
            יצוא קובץ
          </button>
        </div>
      </div>
    </div>
  </form>
</div>
